<!DOCTYPE html>
<html>
<head>
<style>
*, *:before, *:after {
    content: none ;
    margin: 0 ;
    padding: 0 ;
}
body {
    overflow: hidden ;
}
canvas {
    width: 100vw ;
    height: 100vh ;
}
</style>
</head>
<body>
<script type="module">
import {Agni} from '../src/Grids/Agni.js';
import {Canvas2dTileRenderer} from '../src/Renderer.js';
import {BasicUserInterface} from '../src/UserInterface.js';

const AgniInstance = new Agni();

const renderer = new Canvas2dTileRenderer(1, 1, AgniInstance.tileSources[0], 0, [1000, 1000]);

const UI = new BasicUserInterface(renderer);
const move = (e) => {
    e.target.renderer.animator.animate(e.detail.position);
};
UI.addEventListener('click', move);
UI.addEventListener('dragmove', move);
UI.addEventListener('wheel', (e) => {
    const renderer = e.target.renderer;
    renderer.animator.animate(
        UI.mousePosition,
        renderer.zoom + ((e.detail.zoomIn ? -.5 : +.5) * (e.detail.amount / 100))
    );
});
UI.draggable = true;
UI.wheelZoom = true;

document.body.appendChild(renderer.DOMNode);

const sync = () => {
    if (renderer.dirty) {
        renderer.render();
    }

    requestAnimationFrame(sync);
};

requestAnimationFrame(() => {
    renderer.updateAsClientSize();

    sync();
});

window.Agni = AgniInstance;
window.renderer = renderer;
window.ui = UI;
</script>
